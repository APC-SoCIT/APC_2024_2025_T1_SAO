"Reports_1 As screen.'welcomeLayout_ver1.0'":
    OnHidden: |-
        =UpdateContext({ReportLink: Blank()});
    OnVisible: |-
        =Set(isRunning, false);
        If(CurrentUser.userRoles.Id > 1, 
            ClearCollect(LocalAPF,
                AddColumns(Filter('APF Uploads', 'Name of Lead Org' = CurrentUserOrg.orgAcronym), APFU_ID_Num, ID)
            ),
            ClearCollect(LocalAPF, 
                AddColumns('APF Uploads', APFU_ID_Num, ID)
            );
          
        );
        
        If(CurrentUser.userRoles.Id > 1, 
            ClearCollect(LocalLR,
                AddColumns(Filter(LR_Uploads, EventOrg = CurrentUserOrg.orgAcronym), 
                    LR_ID_Num, ID,
                    APF_ID_Num, APF_ID.Id
                );
            ),
            ClearCollect(LocalLR, 
                AddColumns('LR_Uploads', 
                    LR_ID_Num, ID,
                    APF_ID_Num, APF_ID.Id
                );
            );
        );
        
        If(CurrentUser.userRoles.Id > 1, 
            Set(orgReport, CurrentUserOrg.orgAcronym),
            Set(orgReport, "SAOHEAD")
        );
        
        If(CurrentUser.userRoles.Id > 1, 
            ClearCollect(
                LocalPD,
                Filter(LR_PDItems, !IsBlank(LookUp(LocalLR, LR_ID_Num = LR_ID.Id)))
            ),
            ClearCollect(LocalPD, LR_PDItems);
        );
        
        
        
        // Then use the local collection in your formula
        ClearCollect(
            Master_Data,
            AddColumns(
                ShowColumns(LocalAPF,
                    APFU_ID_Num,
                    ID,
                    'Name of Lead Org',
                    Title,
                    'Activity Title',
                    'Target Date',
                    'Venue/Platform',
                    'Workshop/Tech Training',
                    'Seminar/Webinar/Symposium/Forum',
                    'Leadership Training',
                    'Academic Competition',
                    'Culture & Arts',
                    'Games & Sports', 
                    'Religious/Spiritual',
                    'Community Ext', 
                    'Social Events',
                    Marketing,
                    'Projected Primary Audience',
                    'Projected Secondary Audience'
                ),
                EventTypes,
                Concat(
                    Filter(
                        [
                            {Type: "Workshop", Value: ThisRecord.Workshop_x002f_TechTraining},
                            {Type: "Seminar", Value: ThisRecord.Seminar_x002f_Webinar_x002f_Symp},
                            {Type: "Leadership", Value: ThisRecord.LeadershipTraining},
                            {Type: "Academic", Value: ThisRecord.AcademicCompetition},
                            {Type: "Cultural", Value: ThisRecord.CultureArts},
                            {Type: "Sports", Value: ThisRecord.GamesSports},
                            {Type: "Religious", Value: ThisRecord.Religious_x002f_Spiritual},
                            {Type: "Community", Value: ThisRecord.CommunityExt},
                            {Type: "Social", Value: ThisRecord.SocialEvents},
                            {Type: "Marketing", Value: ThisRecord.Marketing}
                        ],
                        Value = true
                    ),
                    Type,
                    "; "
                )
                
                ,CashAdvance,
                If(
                    IsBlank(
                        LookUp(
                            LocalLR,
                            APFU_ID_Num = ThisRecord.APF_ID_Num,
                            CashAdvAmt
                        )
                    ),
                    0,
                    LookUp(
                        LocalLR,
                        APFU_ID_Num = ThisRecord.APF_ID_Num,
                        CashAdvAmt
                    )
                )
                
                ,TotalExpensesValue,
                If(
                    IsBlank(
                        LookUp(
                            LocalLR,
                            ThisRecord.APF_ID_Num = APFU_ID_Num,
                            TotalExpenses
                        )
                    ),
                    0,
                    LookUp(
                        LocalLR,
                        ThisRecord.APF_ID_Num = APFU_ID_Num,
                        TotalExpenses
                    )
                )
        
                ,Balance,
                If(
                    IsBlank(
                        LookUp(
                            LocalLR,
                            ThisRecord.APF_ID_Num = APFU_ID_Num,
                            Balance
                        )
                    ),
                    0,
                    LookUp(
                        LocalLR,
                        ThisRecord.APF_ID_Num = APFU_ID_Num,
                        Balance
                    )
                )
                ,CostPerParticipant,  
                If(
                    Or(Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience) = 0,
                    IsBlank(LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num,TotalExpenses))),
                    0,
                    LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num,TotalExpenses) / Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience)
                )
            )
        );
        
        ClearCollect(EventTypeReports, 
            {
                SeminarCount: CountIf(Master_Data, Seminar_x002f_Webinar_x002f_Symp = true),
                LeadershipCount: CountIf(Master_Data, LeadershipTraining = true),
                CommExtCount: CountIf(Master_Data,CommunityExt = true),
                MarketingCount: CountIf(Master_Data,Marketing = true),
                ReligiousCount: CountIf(Master_Data,Religious_x002f_Spiritual = true),
                AcadCompeCount: CountIf(Master_Data,AcademicCompetition = true),
                CultureCount: CountIf(Master_Data,CultureArts = true),
                GameCount: CountIf(Master_Data,GamesSports = true),
                SocialCount: CountIf(Master_Data,SocialEvents = true)
            }
        );

    ScreenContainer4_1 As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(245, 245, 245, 1)
        Height: =Parent.Height
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =16
        PaddingLeft: =16
        PaddingRight: =16
        PaddingTop: =16
        Width: =Parent.Width
        Y: =60
        ZIndex: =1

        MainContainer3_1 As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(245, 245, 245, 1)
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =16
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowX: =LayoutOverflow.Scroll
            LayoutWrap: =true
            PaddingBottom: =2
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =2
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            ZIndex: =2

            LeftCont As groupContainer.verticalAutoLayoutContainer:
                Fill: =RGBA(255, 255, 255, 1)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =30
                RadiusBottomRight: =30
                RadiusTopLeft: =30
                RadiusTopRight: =30
                ZIndex: =2

                ChartsSlider As groupContainer.horizontalAutoLayoutContainer:
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutOverflowX: =LayoutOverflow.Scroll
                    ZIndex: =1

                    ChartCont As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =350
                        LayoutMode: =LayoutMode.Auto
                        Width: |
                            =350
                        ZIndex: =1

                        ColumnChart2 As barChart:
                            GridStyle: =GridStyle.All
                            Items: =EventTypeReports
                            NumberOfSeries: =9
                            X: =40
                            Y: =70
                            ZIndex: =3

                    LabelCont As groupContainer.manualLayoutContainer:
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0.05
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        ZIndex: =4

                        Legend6_1 As legend:
                            Height: =230
                            ItemColorSet: =ColumnChart2.ItemColorSet
                            Items: =ColumnChart2.SeriesLabels
                            Width: =166
                            X: =42
                            Y: =91
                            ZIndex: =1

                        Title11 As label:
                            Align: =Align.Center
                            Height: =20
                            LineHeight: =1
                            Text: ="Event Type"
                            Width: =250
                            Y: =60
                            ZIndex: =2

                    ChartCont_1 As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =350
                        LayoutMode: =LayoutMode.Auto
                        Width: |
                            =350
                        ZIndex: =5

                        PieChart1 As pieChart:
                            Items: =LocalPD
                            X: =40
                            Y: =70
                            ZIndex: =3

                    LabelCont_1 As groupContainer.manualLayoutContainer:
                        FillPortions: =0.05
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        ZIndex: =6

                        Title2 As label:
                            Align: =Align.Center
                            Height: =25
                            Text: ="Expenses"
                            Width: =250
                            Y: =60
                            ZIndex: =3

                        Legend3 As legend:
                            Height: =200
                            ItemColorSet: =PieChart1.ItemColorSet
                            Items: =PieChart1.SeriesLabels
                            Width: =250
                            Y: |
                                =91
                            ZIndex: =4

                Container13 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.Start
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =Parent.Width
                    X: =165
                    Y: =385
                    ZIndex: =3

                    DataTable2 As dataTable.datatable:
                        BorderStyle: =BorderStyle.Solid
                        DisplayMode: =DisplayMode.Edit
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =Parent.Height
                        Items: =Master_Data
                        Width: =Parent.Width
                        X: =Parent.X
                        Y: =0
                        ZIndex: =2

                        APFU_ID_Num_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="APF ID"
                            FieldName: ="APFU_ID_Num"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =1
                            Text: =ThisItem.APFU_ID_Num
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =16

                        NameofLeadOrg_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Organization"
                            FieldName: ="NameofLeadOrg"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =2
                            Text: =ThisItem.NameofLeadOrg
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =17

                        Title_Column2 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Control Number"
                            FieldName: ="Title"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =3
                            Text: =ThisItem.Title
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =18

                        ActivityTitle_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Activity Title"
                            FieldName: ="ActivityTitle"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =4
                            Text: =ThisItem.ActivityTitle
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =19

                        Target_x0020_Date_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Target Date"
                            FieldName: ="Target_x0020_Date"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =5
                            Text: =ThisItem.Target_x0020_Date
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =20

                        Venue_x002f_Platform_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Venue/Platform"
                            FieldName: ="Venue_x002f_Platform"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =6
                            Text: =ThisItem.Venue_x002f_Platform
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =21

                        EventTypes_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Event Type"
                            FieldName: ="EventTypes"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =7
                            Text: =ThisItem.EventTypes
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =22

                        ProjectedPrimaryAudience_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Primary Audiences"
                            FieldName: ="ProjectedPrimaryAudience"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =8
                            Text: =ThisItem.ProjectedPrimaryAudience
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =23

                        ProjectedSecondaryAudience_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Secondary Audiences"
                            FieldName: ="ProjectedSecondaryAudience"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =9
                            Text: =ThisItem.ProjectedSecondaryAudience
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =24

                        CashAdvance_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Cash Advance"
                            FieldName: ="CashAdvance"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =10
                            Text: =ThisItem.CashAdvance
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =25

                        TotalExpensesValue_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Total Expenses"
                            FieldName: ="TotalExpensesValue"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =11
                            Text: =ThisItem.TotalExpensesValue
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =26

                        Balance_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Balance"
                            FieldName: ="Balance"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =12
                            Text: =ThisItem.Balance
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =27

                        CostPerParticipant_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Cost Per Participant"
                            FieldName: ="CostPerParticipant"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =13
                            Text: =ThisItem.CostPerParticipant
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =28

            "'Right Container' As groupContainer.verticalAutoLayoutContainer":
                DropShadow: =DropShadow.Regular
                Fill: =RGBA(255, 255, 255, 1)
                FillPortions: =0.5
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =5
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =300
                LayoutMinWidth: =If(Reports_1.Size = ScreenSize.Small, Parent.Width, 250)
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =10
                ZIndex: =4

                Container6_1 As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.Light
                    FillPortions: =0.25
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Visible: =If(CurrentUser.userRoles.Id = 1, true, false)
                    ZIndex: =5

                    Dropdown2_1 As dropdown:
                        Default: ="Select an Organization"
                        FontWeight: =FontWeight.Lighter
                        Height: =46
                        Items: =Organizations
                        OnChange: |-
                            =// Update LocalAPF
                            ClearCollect(
                                LocalAPF,
                                AddColumns(
                                    Filter(
                                        'APF Uploads',
                                        'Name of Lead Org' = Dropdown2_1.Selected.orgAcronym // Apply the filter based on dropdown selection
                                    ),
                                    APFU_ID_Num,
                                    ID
                                )
                            );
                            
                            // Update LocalLR
                            ClearCollect(
                                LocalLR,
                                AddColumns(
                                    Filter(
                                        LR_Uploads,
                                        EventOrg = Dropdown2_1.Selected.orgAcronym // Filter based on EventOrg
                                    ),
                                    LR_ID_Num,
                                    ID,
                                    APF_ID_Num,
                                    APF_ID.Id
                                )
                            );
                            
                            // Update LocalPD
                            ClearCollect(
                                LocalPD,
                                Filter(
                                    LR_PDItems,
                                    !IsBlank(
                                        LookUp(
                                            LocalLR,
                                            LR_ID_Num = LR_ID.Id // Check if there is a matching ID in LocalLR
                                        )
                                    )
                                )
                            );
                            
                            // Update Master_Data
                            ClearCollect(
                                Master_Data,
                                AddColumns(
                                    ShowColumns(
                                        LocalAPF,
                                        APFU_ID_Num,
                                        ID,
                                        'Name of Lead Org',
                                        Title,
                                        'Activity Title',
                                        'Target Date',
                                        'Venue/Platform',
                                        'Workshop/Tech Training',
                                        'Seminar/Webinar/Symposium/Forum',
                                        'Leadership Training',
                                        'Academic Competition',
                                        'Culture & Arts',
                                        'Games & Sports',
                                        'Religious/Spiritual',
                                        'Community Ext',
                                        'Social Events',
                                        Marketing,
                                        'Projected Primary Audience',
                                        'Projected Secondary Audience'
                                    ),
                                    EventTypes,
                                    Concat(
                                        Filter(
                                            [
                                                { Type: "Workshop", Value: ThisRecord.Workshop_x002f_TechTraining },
                                                { Type: "Seminar", Value: ThisRecord.Seminar_x002f_Webinar_x002f_Symp },
                                                { Type: "Leadership", Value: ThisRecord.LeadershipTraining },
                                                { Type: "Academic", Value: ThisRecord.AcademicCompetition },
                                                { Type: "Cultural", Value: ThisRecord.CultureArts },
                                                { Type: "Sports", Value: ThisRecord.GamesSports },
                                                { Type: "Religious", Value: ThisRecord.Religious_x002f_Spiritual },
                                                { Type: "Community", Value: ThisRecord.CommunityExt },
                                                { Type: "Social", Value: ThisRecord.SocialEvents },
                                                { Type: "Marketing", Value: ThisRecord.Marketing }
                                            ],
                                            Value = true
                                        ),
                                        Type,
                                        "; "
                                    ),
                                    // Other calculations for CashAdvance, TotalExpenses, Balance
                                    CashAdvance,
                                    If(
                                        IsBlank(
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                CashAdvAmt
                                            )
                                        ),
                                        0,
                                        LookUp(
                                            LocalLR,
                                            APFU_ID_Num = ThisRecord.APF_ID_Num,
                                            CashAdvAmt
                                        )
                                    ),
                                    TotalExpenses,
                                    If(
                                        IsBlank(
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                TotalExpenses
                                            )
                                        ),
                                        0,
                                        LookUp(
                                            LocalLR,
                                            APFU_ID_Num = ThisRecord.APF_ID_Num,
                                            TotalExpenses
                                        )
                                    ),
                                    Balance,
                                    If(
                                        IsBlank(
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                Balance
                                            )
                                        ),
                                        0,
                                        LookUp(
                                            LocalLR,
                                            APFU_ID_Num = ThisRecord.APF_ID_Num,
                                            Balance
                                        )
                                    ),
                                    CostPerParticipant,
                                    If(
                                        Or(
                                            Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience) = 0,
                                            IsBlank(LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num, TotalExpenses))
                                        ),
                                        0,
                                        LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num, TotalExpenses) / 
                                        Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience)
                                    )
                                )
                            );
                            
                            // Update EventTypeReports
                            ClearCollect(
                                EventTypeReports,
                                {
                                    SeminarCount: CountIf(Master_Data, Seminar_x002f_Webinar_x002f_Symp = true),
                                    LeadershipCount: CountIf(Master_Data, LeadershipTraining = true),
                                    CommExtCount: CountIf(Master_Data, CommunityExt = true),
                                    MarketingCount: CountIf(Master_Data, Marketing = true),
                                    ReligiousCount: CountIf(Master_Data, Religious_x002f_Spiritual = true),
                                    AcadCompeCount: CountIf(Master_Data, AcademicCompetition = true),
                                    CultureCount: CountIf(Master_Data, CultureArts = true),
                                    GameCount: CountIf(Master_Data, GamesSports = true),
                                    SocialCount: CountIf(Master_Data, SocialEvents = true)
                                }
                            );
                        Width: =320
                        X: =84
                        Y: =48
                        ZIndex: =6

                    ButtonCanvas2_1 As Button:
                        DisplayMode: =DisplayMode.Edit
                        Height: =46
                        OnSelect: |-
                            =// Reset the dropdown selection
                                Reset(Dropdown2_1);
                            
                                // Update LocalAPF to include all APF Uploads
                                ClearCollect(
                                    LocalAPF,
                                    AddColumns(
                                        'APF Uploads',
                                        APFU_ID_Num,
                                        ID
                                    )
                                );
                            
                                // Update LocalLR to include all LR Uploads
                                ClearCollect(
                                    LocalLR,
                                    AddColumns(
                                        'LR_Uploads',
                                        LR_ID_Num,
                                        ID,
                                        APF_ID_Num,
                                        APF_ID.Id
                                    )
                                );
                            
                                // Update LocalPD to include all relevant PD items
                                ClearCollect(
                                    LocalPD,
                                    Filter(
                                        LR_PDItems,
                                        !IsBlank(
                                            LookUp(
                                                LocalLR,
                                                LR_ID_Num = LR_ID.Id
                                            )
                                        )
                                    )
                                );
                            
                                // Update Master_Data with all items
                                ClearCollect(
                                    Master_Data,
                                    AddColumns(
                                        ShowColumns(
                                            LocalAPF,
                                            APFU_ID_Num,
                                            ID,
                                            'Name of Lead Org',
                                            Title,
                                            'Activity Title',
                                            'Target Date',
                                            'Venue/Platform',
                                            'Workshop/Tech Training',
                                            'Seminar/Webinar/Symposium/Forum',
                                            'Leadership Training',
                                            'Academic Competition',
                                            'Culture & Arts',
                                            'Games & Sports',
                                            'Religious/Spiritual',
                                            'Community Ext',
                                            'Social Events',
                                            Marketing,
                                            'Projected Primary Audience',
                                            'Projected Secondary Audience'
                                        ),
                                        EventTypes,
                                        Concat(
                                            Filter(
                                                [
                                                    { Type: "Workshop", Value: ThisRecord.Workshop_x002f_TechTraining },
                                                    { Type: "Seminar", Value: ThisRecord.Seminar_x002f_Webinar_x002f_Symp },
                                                    { Type: "Leadership", Value: ThisRecord.LeadershipTraining },
                                                    { Type: "Academic", Value: ThisRecord.AcademicCompetition },
                                                    { Type: "Cultural", Value: ThisRecord.CultureArts },
                                                    { Type: "Sports", Value: ThisRecord.GamesSports },
                                                    { Type: "Religious", Value: ThisRecord.Religious_x002f_Spiritual },
                                                    { Type: "Community", Value: ThisRecord.CommunityExt },
                                                    { Type: "Social", Value: ThisRecord.SocialEvents },
                                                    { Type: "Marketing", Value: ThisRecord.Marketing }
                                                ],
                                                Value = true
                                            ),
                                            Type,
                                            "; "
                                        ),
                                        CashAdvance,
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    LocalLR,
                                                    APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                    CashAdvAmt
                                                )
                                            ),
                                            0,
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                CashAdvAmt
                                            )
                                        ),
                                        TotalExpenses,
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    LocalLR,
                                                    APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                    TotalExpenses
                                                )
                                            ),
                                            0,
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                TotalExpenses
                                            )
                                        ),
                                        Balance,
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    LocalLR,
                                                    APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                    Balance
                                                )
                                            ),
                                            0,
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                Balance
                                            )
                                        ),
                                        CostPerParticipant,
                                        If(
                                            Or(
                                                Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience) = 0,
                                                IsBlank(LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num, TotalExpenses))
                                            ),
                                            0,
                                            LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num, TotalExpenses) / 
                                            Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience)
                                        )
                                    )
                                );
                            
                                // Update EventTypeReports
                                ClearCollect(
                                    EventTypeReports,
                                    {
                                        SeminarCount: CountIf(Master_Data, Seminar_x002f_Webinar_x002f_Symp = true),
                                        LeadershipCount: CountIf(Master_Data, LeadershipTraining = true),
                                        CommExtCount: CountIf(Master_Data, CommunityExt = true),
                                        MarketingCount: CountIf(Master_Data, Marketing = true),
                                        ReligiousCount: CountIf(Master_Data, Religious_x002f_Spiritual = true),
                                        AcadCompeCount: CountIf(Master_Data, AcademicCompetition = true),
                                        CultureCount: CountIf(Master_Data, CultureArts = true),
                                        GameCount: CountIf(Master_Data, GamesSports = true),
                                        SocialCount: CountIf(Master_Data, SocialEvents = true)
                                    }
                                )
                        Text: ="All"
                        Width: =54
                        X: =10
                        Y: =48
                        ZIndex: =7

                    Icon21_2 As icon.VerticalLine:
                        Height: =46
                        Icon: =Icon.VerticalLine
                        Width: =20
                        X: =64
                        Y: =48
                        ZIndex: =8

                Container6_2 As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.Light
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    ZIndex: =6

                    TextCanvas6 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =63
                        Size: =30
                        Text: |-
                            ="Quick Stats:"
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =193
                        X: =40
                        Y: =59
                        ZIndex: =1

                    TextCanvas6_1 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Events Organized:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =193
                        X: =40
                        Y: =172
                        ZIndex: =2

                    TextCanvas6_2 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Total Participation:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =193
                        X: =40
                        Y: =270
                        ZIndex: =3

                    TextCanvas6_3 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Upcoming Events:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =193
                        X: =40
                        Y: =221
                        ZIndex: =4

                    TextCanvas6_5 As Text:
                        Align: ="Start"
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Total Budget Utilized:"
                        VerticalAlign: ="Middle"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =264
                        X: =40
                        Y: =319
                        ZIndex: =6

                    TextCanvas6_6 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Average Cost per Participant:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =296
                        X: =40
                        Y: =368
                        ZIndex: =7

                    TextCanvas6_7 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: =CountRows(Master_Data)
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =286
                        Y: =172
                        ZIndex: =8

                    TextCanvas6_8 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: =Sum(Master_Data, ProjectedPrimaryAudience) + Sum(Master_Data, ProjectedSecondaryAudience)
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =286
                        Y: =270
                        ZIndex: =9

                    TextCanvas6_9 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: =CountIf(Master_Data,Target_x0020_Date >= Today())
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =286
                        Y: =221
                        ZIndex: =10

                    TextCanvas6_11 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: =Concatenate(Round(Sum(Master_Data, TotalExpenses) / 11000 * 100,2), "%")
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =286
                        Y: =319
                        ZIndex: =12

                    TextCanvas6_12 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: =Round(Sum(Master_Data,CostPerParticipant),2)
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =286
                        Y: =368
                        ZIndex: =13

                    ButtonCanvas1_1 As Button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =18
                        Height: =46
                        Icon: ="ArrowDownload"
                        OnSelect: |-
                            =Set(isRunning,true);
                            Set(reportOutput, ExportReport.Run(JSON(Master_Data),orgReport));
                            Set(isRunning, false);
                        Text: ="Export Report"
                        Width: =204
                        X: =116
                        Y: =468
                        ZIndex: =14

                Container16 As groupContainer.manualLayoutContainer:
                    AlignInContainer: ='Right Container'.AlignInContainer
                    DropShadow: =DropShadow.Light
                    Fill: =RGBA(0, 0, 0, 0.14)
                    FillPortions: =0.3
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    ZIndex: =7

                    ReportLink As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =82
                        Size: =15
                        Text: =reportOutput.reportlink
                        Width: =381
                        X: =24
                        Y: =20
                        ZIndex: =1

    TSKBR_14 As TSKBR:
        NavigationItems: =gblNavItems
        ZIndex: =3

    SetDelay_2 As timer:
        Duration: =6000
        Height: =0
        OnTimerEnd: |-
            =
            Set(isRunning, true); 
            Set(TimerDone, true);
        OnTimerStart: |-
            =SetDelay_2;
            Set(isRunning, false);
            Set(TimerDone, false);
        Repeat: =isRunning
        Reset: =TimerDone
        Width: =0
        Y: =768
        ZIndex: =4

    LoadScreenPanel_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =8

        Rectangle6_8 As rectangle:
            Fill: =RGBA(0, 0, 0, 0.2)
            Height: =768
            Visible: =isRunning
            Width: =1366
            ZIndex: =2

        Rectangle6_7 As rectangle:
            Fill: =RGBA(24, 32, 82, 1)
            Height: =330
            Visible: =isRunning
            Width: =825
            X: =275
            Y: =238
            ZIndex: =5

        Image7_4 As image:
            Image: ='Spinner-1.5s-200px'
            Visible: =isRunning
            X: =633
            Y: =442
            ZIndex: =6

        Label2_4 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.'Lato Black'
            Height: =214
            Size: =30
            Text: ="Processing your document. Please wait."
            Visible: =isRunning
            Width: =624
            X: =371
            Y: =267
            ZIndex: =7

