"Reports_1 As screen.'welcomeLayout_ver1.0'":
    OnHidden: |-
        =UpdateContext({ReportLink: Blank()});
    OnVisible: |
        =Set(isRunning, false);
        If(CurrentUser.userRoles.Id > 1, 
            ClearCollect(LocalAPF,
                AddColumns(Filter('APF Uploads', 'Name of Lead Org' = CurrentUserOrg.orgAcronym && IsApproved = true), APFU_ID_Num, ID)
            ),
            ClearCollect(LocalAPF, 
                AddColumns(Filter('APF Uploads', IsApproved = true),APFU_ID_Num, ID)
            );
          
        );
        
        If(CurrentUser.userRoles.Id > 1, 
            ClearCollect(LocalLR,
                AddColumns(Filter(LR_Uploads, EventOrg = CurrentUserOrg.orgAcronym), 
                    LR_ID_Num, ID,
                    APF_ID_Num, APF_ID.Id
                );
            ),
            ClearCollect(LocalLR, 
                AddColumns('LR_Uploads', 
                    LR_ID_Num, ID,
                    APF_ID_Num, APF_ID.Id
                );
            );
        );
        
        If(CurrentUser.userRoles.Id > 1, 
            Set(orgReport, CurrentUserOrg.orgAcronym),
            Set(orgReport, "SAOHEAD")
        );
        
        If(CurrentUser.userRoles.Id > 1, 
            ClearCollect(
                LocalPD,
                Filter(LR_PDItems, !IsBlank(LookUp(LocalLR, LR_ID_Num = LR_ID.Id)))
            ),
            ClearCollect(LocalPD, LR_PDItems);
        );
        
        
        
        // Then use the local collection in your formula
        ClearCollect(
            Master_Data,
            AddColumns(
                ShowColumns(LocalAPF,
                    APFU_ID_Num,
                    ID,
                    'Name of Lead Org',
                    Title,
                    'Activity Title',
                    'Target Date',
                    'Venue/Platform',
                    'Workshop/Tech Training',
                    'Seminar/Webinar/Symposium/Forum',
                    'Leadership Training',
                    'Academic Competition',
                    'Culture & Arts',
                    'Games & Sports', 
                    'Religious/Spiritual',
                    'Community Ext', 
                    'Social Events',
                    Marketing,
                    'Projected Primary Audience',
                    'Projected Secondary Audience'
                ),
                EventTypes,
                Concat(
                    Filter(
                        [
                            {Type: "Workshop", Value: ThisRecord.Workshop_x002f_TechTraining},
                            {Type: "Seminar", Value: ThisRecord.Seminar_x002f_Webinar_x002f_Symp},
                            {Type: "Leadership", Value: ThisRecord.LeadershipTraining},
                            {Type: "Academic", Value: ThisRecord.AcademicCompetition},
                            {Type: "Cultural", Value: ThisRecord.CultureArts},
                            {Type: "Sports", Value: ThisRecord.GamesSports},
                            {Type: "Religious", Value: ThisRecord.Religious_x002f_Spiritual},
                            {Type: "Community", Value: ThisRecord.CommunityExt},
                            {Type: "Social", Value: ThisRecord.SocialEvents},
                            {Type: "Marketing", Value: ThisRecord.Marketing}
                        ],
                        Value = true
                    ),
                    Type,
                    "; "
                )
                
                ,CashAdvance,
                If(
                    IsBlank(
                        LookUp(
                            LocalLR,
                            APFU_ID_Num = ThisRecord.APF_ID_Num,
                            CashAdvAmt
                        )
                    ),
                    0,
                    LookUp(
                        LocalLR,
                        APFU_ID_Num = ThisRecord.APF_ID_Num,
                        CashAdvAmt
                    )
                )
                
                ,TotalExpensesValue,
                If(
                    IsBlank(
                        LookUp(
                            LocalLR,
                            ThisRecord.APF_ID_Num = APFU_ID_Num,
                            TotalExpenses
                        )
                    ),
                    0,
                    LookUp(
                        LocalLR,
                        ThisRecord.APF_ID_Num = APFU_ID_Num,
                        TotalExpenses
                    )
                )
        
                ,Balance,
                If(
                    IsBlank(
                        LookUp(
                            LocalLR,
                            ThisRecord.APF_ID_Num = APFU_ID_Num,
                            Balance
                        )
                    ),
                    0,
                    LookUp(
                        LocalLR,
                        ThisRecord.APF_ID_Num = APFU_ID_Num,
                        Balance
                    )
                )
                ,CostPerParticipant,  
                If(
                    Or(Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience) = 0,
                    IsBlank(LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num,TotalExpenses))),
                    0,
                    LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num,TotalExpenses) / Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience)
                )
            )
        );
        
        
        ClearCollect(EventTypeReports, 
            {
                SeminarCount: CountIf(Master_Data, Seminar_x002f_Webinar_x002f_Symp = true),
                LeadershipCount: CountIf(Master_Data, LeadershipTraining = true),
                CommExtCount: CountIf(Master_Data,CommunityExt = true),
                MarketingCount: CountIf(Master_Data,Marketing = true),
                ReligiousCount: CountIf(Master_Data,Religious_x002f_Spiritual = true),
                AcadCompeCount: CountIf(Master_Data,AcademicCompetition = true),
                CultureCount: CountIf(Master_Data,CultureArts = true),
                GameCount: CountIf(Master_Data,GamesSports = true),
                SocialCount: CountIf(Master_Data,SocialEvents = true)
            }
        );

    ScreenContainer4_1 As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(245, 245, 245, 1)
        Height: =Parent.Height
        LayoutGap: =16
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =16
        PaddingLeft: =16
        PaddingRight: =16
        PaddingTop: =16
        Width: =Parent.Width
        Y: =60
        ZIndex: =1

        MainContainer3_1 As groupContainer.horizontalAutoLayoutContainer:
            Fill: =RGBA(245, 245, 245, 1)
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =16
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowX: =LayoutOverflow.Scroll
            LayoutWrap: =true
            PaddingBottom: =2
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =2
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            ZIndex: =1

            LeftCont As groupContainer.verticalAutoLayoutContainer:
                Fill: =RGBA(255, 255, 255, 1)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =30
                RadiusBottomRight: =30
                RadiusTopLeft: =30
                RadiusTopRight: =30
                ZIndex: =1

                ChartsSlider As groupContainer.horizontalAutoLayoutContainer:
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    LayoutOverflowX: =LayoutOverflow.Scroll
                    Visible: =If(openExportFilters = true, false, true)
                    ZIndex: =1

                    ChartCont As groupContainer.verticalAutoLayoutContainer:
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =350
                        LayoutMode: =LayoutMode.Auto
                        Width: |
                            =350
                        ZIndex: =1

                        ColumnChart2 As barChart:
                            GridStyle: =GridStyle.All
                            Items: |-
                                =// EventTypeReports
                                
                                Switch(
                                    true,
                                    
                                    IsBlank(OrgSelectorReport.SelectedText.Value) && IsBlank(AcadYearSelector3.SelectedText.Value),
                                        Table({
                                            'Seminar/Webinar Count': CountIf(Master_Data, Seminar_x002f_Webinar_x002f_Symp = true),
                                            'LeadershipCount': CountIf(Master_Data, LeadershipTraining = true),
                                            'Community Extension': CountIf(Master_Data, CommunityExt = true),
                                            'Marketing Count': CountIf(Master_Data, Marketing = true),
                                            'Religious Count': CountIf(Master_Data, Religious_x002f_Spiritual = true),
                                            'Acad Competitions Count': CountIf(Master_Data, AcademicCompetition = true),
                                            'Culture/Arts Count': CountIf(Master_Data, CultureArts = true),
                                            'Game/Sports Count': CountIf(Master_Data, GamesSports = true),
                                            'Social Events Count': CountIf(Master_Data, SocialEvents = true)
                                        }),
                                    
                                    IsBlank(OrgSelectorReport.SelectedText.Value) && !IsBlank(AcadYearSelector3.SelectedText.Value),
                                        Table({
                                            'Seminar/Webinar Count': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                Seminar_x002f_Webinar_x002f_Symp = true
                                            ),
                                            'LeadershipCount': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                LeadershipTraining = true
                                            ),
                                            'Community Extension': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                CommunityExt = true
                                            ),
                                            'Marketing Count': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                Marketing = true
                                            ),
                                            'Religious Count': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                Religious_x002f_Spiritual = true
                                            ),
                                            'Acad Competitions Count': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month (DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                AcademicCompetition = true
                                            ),
                                            'Culture/Arts Count': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                CultureArts = true
                                            ),
                                            'Game/Sports Count': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                GamesSports = true
                                            ),
                                            'Social Events Count': CountIf(
                                                Filter(Master_Data,
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                SocialEvents = true
                                            )
                                        }),
                                    
                                    !IsBlank(OrgSelectorReport.SelectedText.Value) && IsBlank(AcadYearSelector3.SelectedText.Value),
                                        Table({
                                            'Seminar/Webinar Count': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                Seminar_x002f_Webinar_x002f_Symp = true
                                            ),
                                            'LeadershipCount': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                LeadershipTraining = true
                                            ),
                                            'Community Extension': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                CommunityExt = true
                                            ),
                                            'Marketing Count': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                Marketing = true
                                            ),
                                            'Religious Count': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                Religious_x002f_Spiritual = true
                                            ),
                                            'Acad Competitions Count': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                AcademicCompetition = true
                                            ),
                                            'Culture/Arts Count': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                CultureArts = true
                                            ),
                                            'Game/Sports Count': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                GamesSports = true
                                            ),
                                            'Social Events Count': CountIf(
                                                Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.Value),
                                                SocialEvents = true
                                            )
                                        }),
                                    
                                    !IsBlank(OrgSelectorReport.SelectedText.Value) && !IsBlank(AcadYearSelector3.SelectedText.Value),
                                        Table({
                                            'Seminar/Webinar Count': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                Seminar_x002f_Webinar_x002f_Symp = true
                                            ),
                                            'LeadershipCount': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year (DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                LeadershipTraining = true
                                            ),
                                            'Community Extension': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                CommunityExt = true
                                            ),
                                            'Marketing Count': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                Marketing = true
                                            ),
                                            'Religious Count': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                Religious_x002f_Spiritual = true
                                            ),
                                            'Acad Competitions Count': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                AcademicCompetition = true
                                            ),
                                            'Culture/Arts Count': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                CultureArts = true
                                            ),
                                            'Game/Sports Count': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                GamesSports = true
                                            ),
                                            'Social Events Count': CountIf(
                                                Filter(Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.Value &&
                                                    Text(Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), "[$-en-US]0") & "-" & 
                                                    Text(Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), "[$-en-US]0") = AcadYearSelector3.SelectedText.Value
                                                ),
                                                SocialEvents = true
                                            )
                                        })
                                )
                                /*
                                If(OrgSelectorReport.SelectedText.Value = Blank(),   
                                    Table({
                                            'Seminar/Webinar Count': CountIf(Master_Data, Seminar_x002f_Webinar_x002f_Symp = true),
                                            'LeadershipCount': CountIf(Master_Data, LeadershipTraining = true),
                                            'Community Extension': CountIf(Master_Data,CommunityExt = true),
                                            'Marketing Count': CountIf(Master_Data,Marketing = true),
                                            'Religious Count': CountIf(Master_Data,Religious_x002f_Spiritual = true),
                                            'Acad Competitions Count': CountIf(Master_Data,AcademicCompetition = true),
                                            'Culture/Arts Count': CountIf(Master_Data,CultureArts = true),
                                            'Game/Sports Count': CountIf(Master_Data,GamesSports = true),
                                            'Social Events Count': CountIf(Master_Data,SocialEvents = true)
                                        }),
                                    Table({
                                            'Seminar/Webinar Count': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value), Seminar_x002f_Webinar_x002f_Symp = true),
                                            'LeadershipCount': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value), LeadershipTraining = true),
                                            'Community Extension': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value),CommunityExt = true),
                                            'Marketing Count': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value),Marketing = true),
                                            'Religious Count': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value),Religious_x002f_Spiritual = true),
                                            'Acad Competitions Count': CountIf(Filter(Master_Data,NameofLeadOrg =OrgSelectorReport.SelectedText.Value),AcademicCompetition = true),
                                            'Culture/Arts Count': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value),CultureArts = true),
                                            'Game/Sports Count': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value),GamesSports = true),
                                            'Social Events Count': CountIf(Filter(Master_Data,NameofLeadOrg= OrgSelectorReport.SelectedText.Value),SocialEvents = true)
                                        })
                                )
                                */
                            NumberOfSeries: =9
                            PaddingLeft: =20
                            PaddingRight: =80
                            Width: =Parent.Width
                            Y: =70
                            ZIndex: =3

                    LabelCont As groupContainer.manualLayoutContainer:
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0.05
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        ZIndex: =4

                        Legend6_1 As legend:
                            Height: =230
                            ItemColorSet: =ColumnChart2.ItemColorSet
                            Items: =ColumnChart2.SeriesLabels
                            Width: =210
                            X: =20
                            Y: =80
                            ZIndex: =1

                        Title11 As label:
                            Align: =Align.Center
                            Height: =20
                            LineHeight: =1
                            Text: ="Event Type"
                            Width: =250
                            Y: =60
                            ZIndex: =2

                    ChartCont_1 As groupContainer.verticalAutoLayoutContainer:
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =350
                        LayoutMode: =LayoutMode.Auto
                        Width: |
                            =350
                        ZIndex: =5

                        PieChart1 As pieChart:
                            Items: |-
                                =If(
                                    IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'), 
                                    LocalPD,
                                    Filter(
                                        LocalPD, 
                                        LR_ID.Id in Filter(LocalLR, EventOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName').ID
                                    )
                                )
                            OnSelect: |-
                                =Set(ToggleLocalPDViewer, true); // Show the hidden data table
                                Set(SelectedPDTitle, PieChart1.Selected.Name); // Store the selected title from the pie chart
                                
                                // Update the Data Table Items collection based on the selected organization
                                ClearCollect(
                                    FilteredDataTable,
                                    If(
                                        IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'),
                                        LocalPD, // Show all data if the dropdown is empty
                                        Filter(
                                            LocalPD,
                                            LR_ID.Id in Filter(LocalLR, EventOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName').ID
                                        )
                                    )    
                                );
                            X: =40
                            Y: =70
                            ZIndex: =3

                    LabelCont_1 As groupContainer.manualLayoutContainer:
                        FillPortions: =0.05
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        ZIndex: =6

                        Title2 As label:
                            Align: =Align.Center
                            Height: =25
                            Text: ="Expenses"
                            Width: =250
                            Y: =60
                            ZIndex: =3

                        Legend3 As legend:
                            Height: =200
                            ItemColorSet: =PieChart1.ItemColorSet
                            Items: =PieChart1.SeriesLabels
                            Width: =250
                            Y: |
                                =91
                            ZIndex: =4

                Container13 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.Start
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =If(openExportFilters = true, false, true)
                    Width: =Parent.Width
                    X: =165
                    Y: =385
                    ZIndex: =3

                    DataTable2 As dataTable.datatable:
                        BorderStyle: =BorderStyle.Solid
                        DisplayMode: =DisplayMode.Edit
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =321
                        Items: |-
                            =/*
                            Filter(
                                Master_Data,
                                (NameofLeadOrg = OrgSelectorReport.SelectedText.Value ||
                                OrgSelectorReport.SelectedText.Value = Blank())
                            )
                            */
                            
                            Filter(
                                Master_Data,
                                (NameofLeadOrg = OrgSelectorReport.SelectedText.Value || 
                                OrgSelectorReport.SelectedText.Value = Blank()) &&
                                (
                                    If(
                                        Month(DateValue('Target_x0020_Date')) = 8 || Month(DateValue('Target_x0020_Date')) > 8,
                                        Text(Year(DateValue('Target_x0020_Date')), "[$-en-US]0") & "-" & Text(Year(DateValue('Target_x0020_Date')) + 1, "[$-en-US]0"),
                                        Text(Year(DateValue('Target_x0020_Date')) - 1, "[$-en-US]0") & "-" & Text(Year(DateValue('Target_x0020_Date')), "[$-en-US]0")
                                    ) = AcadYearSelector3.Selected.Value || 
                                    AcadYearSelector3.Selected.Value = Blank()
                                )
                            )
                        Width: =Parent.Width
                        X: =Parent.X
                        Y: =45
                        ZIndex: =1

                        APFU_ID_Num_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="APF ID"
                            FieldName: ="APFU_ID_Num"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =1
                            Text: =ThisItem.APFU_ID_Num
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =16

                        NameofLeadOrg_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Organization"
                            FieldName: ="NameofLeadOrg"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =2
                            Text: =ThisItem.NameofLeadOrg
                            Width: =100
                            X: =541
                            Y: =0
                            ZIndex: =17

                        Title_Column2 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Control Number"
                            FieldName: ="Title"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =3
                            Text: =ThisItem.Title
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =18

                        ActivityTitle_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Activity Title"
                            FieldName: ="ActivityTitle"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =4
                            Text: =ThisItem.ActivityTitle
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =19

                        Target_x0020_Date_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Target Date"
                            FieldName: ="Target_x0020_Date"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =5
                            Text: =ThisItem.Target_x0020_Date
                            Width: =100
                            X: =691
                            Y: =0
                            ZIndex: =20

                        Venue_x002f_Platform_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Venue/Platform"
                            FieldName: ="Venue_x002f_Platform"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =6
                            Text: =ThisItem.Venue_x002f_Platform
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =21

                        EventTypes_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Event Type"
                            FieldName: ="EventTypes"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =7
                            Text: =ThisItem.EventTypes
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =22

                        ProjectedPrimaryAudience_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Primary Audiences"
                            FieldName: ="ProjectedPrimaryAudience"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =8
                            Text: =ThisItem.ProjectedPrimaryAudience
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =23

                        ProjectedSecondaryAudience_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Secondary Audiences"
                            FieldName: ="ProjectedSecondaryAudience"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =9
                            Text: =ThisItem.ProjectedSecondaryAudience
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =24

                        CashAdvance_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Cash Advance"
                            FieldName: ="CashAdvance"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =10
                            Text: =ThisItem.CashAdvance
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =25

                        TotalExpensesValue_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Total Expenses"
                            FieldName: ="TotalExpensesValue"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =11
                            Text: =ThisItem.TotalExpensesValue
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =26

                        Balance_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Balance"
                            FieldName: ="Balance"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =12
                            Text: =ThisItem.Balance
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =27

                        CostPerParticipant_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Cost Per Participant"
                            FieldName: ="CostPerParticipant"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =13
                            Text: =ThisItem.CostPerParticipant
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =28

                    LocPDViewer As Button:
                        Appearance: =
                        BasePaletteColor: =RGBA(24, 32, 82, 1)
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Dashed
                        BorderThickness: =1
                        DisplayMode: =DisplayMode.Edit
                        Height: =Parent.Height - DataTable2.Height
                        Icon: ="ChevronDown"
                        IconStyle: ='ButtonCanvas.IconStyle'.Filled
                        OnSelect: =Set(ToggleLocalPDViewer,true)
                        Text: =
                        Visible: =If(openExportFilters = true, false, true)
                        Width: =876
                        X: =0
                        Y: =0
                        ZIndex: =2

                    LocalPDCont As groupContainer.manualLayoutContainer:
                        Fill: =RGBA(9, 33, 98, 1)
                        Height: =319
                        Visible: =ToggleLocalPDViewer
                        Width: =876
                        ZIndex: =3

                        ButtonCanvas6 As Button:
                            Appearance: =
                            BasePaletteColor: =RGBA(24, 32, 82, 1)
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Icon: ="ChevronUp"
                            OnSelect: =Set(ToggleLocalPDViewer,false)
                            Text: =
                            Width: =876
                            X: =0
                            Y: =287
                            ZIndex: =1

                        Container20 As groupContainer.horizontalAutoLayoutContainer:
                            Height: =247
                            LayoutMode: =LayoutMode.Auto
                            LayoutOverflowX: =LayoutOverflow.Scroll
                            Width: =Parent.Width
                            Y: =40
                            ZIndex: =2

                            LocalPDGallery As gallery.galleryVertical:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                DelayItemLoading: =true
                                FillPortions: =0
                                Height: =244
                                Items: =FilteredDataTable
                                Layout: =Layout.Vertical
                                LayoutMinHeight: =287
                                LayoutMinWidth: =320
                                LoadingSpinner: =LoadingSpinner.Data
                                ShowScrollbar: =false
                                TemplateFill: =If(ThisItem.Title = SelectedPDTitle, RGBA(100, 100, 150,1), Color.Transparent)
                                TemplatePadding: =2
                                TemplateSize: =30
                                Transition: =Transition.Pop
                                Width: =Parent.Width
                                ZIndex: =1

                                Col2 As Text:
                                    Align: ='TextCanvas.Align'.Center
                                    BorderColor: =RGBA(255, 255, 255, 1)
                                    BorderStyle: =BorderStyle.Solid
                                    BorderThickness: =0.25
                                    DisplayMode: =DisplayMode.Edit
                                    Fill: =
                                    FontColor: =RGBA(255, 255, 255, 1)
                                    FontStrikethrough: =false
                                    FontUnderline: =false
                                    Height: =30
                                    Text: =ThisItem.ID
                                    Width: =71
                                    X: =0
                                    Y: =0
                                    ZIndex: =2

                                Col2_1 As Text:
                                    Align: ='TextCanvas.Align'.Start
                                    BorderColor: =RGBA(255, 255, 255, 1)
                                    BorderStyle: =BorderStyle.Solid
                                    BorderThickness: =0.25
                                    DisplayMode: =DisplayMode.Edit
                                    Fill: =
                                    FontColor: =RGBA(255, 255, 255, 1)
                                    FontStrikethrough: =false
                                    FontUnderline: =false
                                    Height: =30
                                    Text: =Concatenate("  ",ThisItem.Name)
                                    Width: =355
                                    X: =382
                                    Y: =0
                                    ZIndex: =3

                                Col2_2 As Text:
                                    Align: ='TextCanvas.Align'.Center
                                    BorderColor: =RGBA(255, 255, 255, 1)
                                    BorderStyle: =BorderStyle.Solid
                                    BorderThickness: =0.25
                                    DisplayMode: =DisplayMode.Edit
                                    Fill: =
                                    FontColor: =RGBA(255, 255, 255, 1)
                                    FontStrikethrough: =false
                                    FontUnderline: =false
                                    Height: =30
                                    Text: =ThisItem.PD_Amt
                                    Width: =71
                                    X: =311
                                    Y: =0
                                    ZIndex: =4

                                Col2_3 As Text:
                                    Align: ='TextCanvas.Align'.Center
                                    BorderColor: =RGBA(255, 255, 255, 1)
                                    BorderStyle: =BorderStyle.Solid
                                    BorderThickness: =0.25
                                    DisplayMode: =DisplayMode.Edit
                                    Fill: =
                                    FontColor: =RGBA(255, 255, 255, 1)
                                    FontStrikethrough: =false
                                    FontUnderline: =false
                                    Height: =30
                                    Text: =ThisItem.LR_ID.Value
                                    Width: =71
                                    X: =71
                                    Y: =0
                                    ZIndex: =5

                                Col2_4 As Text:
                                    Align: ='TextCanvas.Align'.Start
                                    BorderColor: =RGBA(255, 255, 255, 1)
                                    BorderStyle: =BorderStyle.Solid
                                    BorderThickness: =0.25
                                    DisplayMode: =DisplayMode.Edit
                                    Fill: =
                                    FontColor: =RGBA(255, 255, 255, 1)
                                    FontStrikethrough: =false
                                    FontUnderline: =false
                                    Height: =30
                                    Text: =Concatenate("  ", ThisItem.PD_Date)
                                    Width: =169
                                    X: =142
                                    Y: =0
                                    ZIndex: =6

                                Col2_5 As Text:
                                    Align: ='TextCanvas.Align'.Start
                                    BorderColor: =RGBA(255, 255, 255, 1)
                                    BorderStyle: =BorderStyle.Solid
                                    BorderThickness: =0.25
                                    DisplayMode: =DisplayMode.Edit
                                    Fill: =
                                    FontColor: =RGBA(255, 255, 255, 1)
                                    FontStrikethrough: =false
                                    FontUnderline: =false
                                    Height: =30
                                    Text: =Concatenate("  ",ThisItem.PD_Price)
                                    Width: =130
                                    X: =737
                                    Y: =0
                                    ZIndex: =7

                        TextCanvas13 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =RGBA(255, 255, 255, 1)
                            BorderStyle: =BorderStyle.Solid
                            BorderThickness: =1
                            DisplayMode: =DisplayMode.Edit
                            Fill: =RGBA(39, 113, 194, 1)
                            FontColor: =RGBA(255, 255, 255, 1)
                            FontUnderline: =false
                            Height: =32
                            Text: ="ID"
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =71
                            X: =0
                            Y: =8
                            ZIndex: =3

                        TextCanvas13_1 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =RGBA(255, 255, 255, 1)
                            BorderStyle: =BorderStyle.Solid
                            BorderThickness: =1
                            DisplayMode: =DisplayMode.Edit
                            Fill: =RGBA(39, 113, 194, 1)
                            FontColor: =RGBA(255, 255, 255, 1)
                            FontUnderline: =false
                            Height: =32
                            Text: ="LR ID"
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =71
                            X: =71
                            Y: =8
                            ZIndex: =4

                        TextCanvas13_2 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =RGBA(255, 255, 255, 1)
                            BorderStyle: =BorderStyle.Solid
                            BorderThickness: =1
                            DisplayMode: =DisplayMode.Edit
                            Fill: =RGBA(39, 113, 194, 1)
                            FontColor: =RGBA(255, 255, 255, 1)
                            FontUnderline: =false
                            Height: =32
                            Text: =" Date"
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =169
                            X: =142
                            Y: =8
                            ZIndex: =5

                        TextCanvas13_3 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =RGBA(255, 255, 255, 1)
                            BorderStyle: =BorderStyle.Solid
                            BorderThickness: =1
                            DisplayMode: =DisplayMode.Edit
                            Fill: =RGBA(39, 113, 194, 1)
                            FontColor: =RGBA(255, 255, 255, 1)
                            FontUnderline: =false
                            Height: =32
                            Text: ="Amt"
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =71
                            X: =311
                            Y: =8
                            ZIndex: =6

                        TextCanvas13_4 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =RGBA(255, 255, 255, 1)
                            BorderStyle: =BorderStyle.Solid
                            BorderThickness: =1
                            DisplayMode: =DisplayMode.Edit
                            Fill: =RGBA(39, 113, 194, 1)
                            FontColor: =RGBA(255, 255, 255, 1)
                            FontUnderline: =false
                            Height: =32
                            Text: ="Price"
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =128
                            X: =740
                            Y: =8
                            ZIndex: =7

                        TextCanvas13_5 As Text:
                            Align: ='TextCanvas.Align'.Center
                            BorderColor: =RGBA(255, 255, 255, 1)
                            BorderStyle: =BorderStyle.Solid
                            BorderThickness: =1
                            DisplayMode: =DisplayMode.Edit
                            Fill: =RGBA(39, 113, 194, 1)
                            FontColor: =RGBA(255, 255, 255, 1)
                            FontUnderline: =false
                            Height: =32
                            Text: ="Items"
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =358
                            X: =382
                            Y: =8
                            ZIndex: =8

                ExportFilters As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.Bold
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =openExportFilters
                    ZIndex: =4

                    ChkBoxGal As gallery.galleryVertical:
                        DelayItemLoading: =true
                        Height: =267
                        Items: =Organizations
                        Layout: =Layout.Vertical
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplateSize: =31
                        Width: =214
                        X: =34
                        Y: =132
                        ZIndex: =1

                        ChkBoxOrgNames As Checkbox:
                            Checked: =SelectAllOrgChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: =ThisItem.orgAcronym
                            OnCheck: =false
                            OnSelect: =Select(Parent)
                            OnUncheck: =false
                            Width: =160
                            X: =20
                            Y: =20
                            ZIndex: =1

                    TextCanvas10 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =80
                        Size: =30
                        Text: ="Export Preview"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =361
                        X: =48
                        Y: =31
                        ZIndex: =2

                    TextCanvas10_2 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =54
                        Size: =20
                        Text: |-
                            ="Information: "
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =148
                        X: =376
                        Y: =108
                        ZIndex: =3

                    ButtonCanvas9 As Button:
                        DisplayMode: =DisplayMode.Edit
                        Height: =32
                        OnSelect: |-
                            =// Step 1: Collect selected organizations
                            ClearCollect(
                                SelectedOrganizations,
                                If(
                                    CurrentUser .userRoles.Id = 1,
                                    Filter(
                                        ChkBoxGal.AllItems,
                                        ChkBoxOrgNames.Checked // Assuming this is a checkbox in your gallery
                                    ),
                                    // If the user role is not 1, set SelectedOrganizations to the current user's organization record
                                    [CurrentUserOrg] // Wrap in a collection format
                                )
                            );
                            
                            // Step 2: Validation for checkbox selections and selected organizations
                            If(
                                IsEmpty(SelectedOrganizations) || 
                                !(
                                    ChkBox_EventID.Checked || 
                                    ChkBox_ActTitle.Checked || 
                                    ChkBox_LeadOrg.Checked || 
                                    ChkBox_EventType.Checked || 
                                    ChkBox_TDate.Checked || 
                                    ChkBox_Venue.Checked || 
                                    ChkBox_PrimAud.Checked || 
                                    ChkBox_SecAud.Checked || 
                                    ChkBox_Balance.Checked || 
                                    ChkBox_CPP.Checked || 
                                    ChkBox_CashAdv.Checked || 
                                    ChkBox_TotalExp.Checked
                                ),
                                Notify("Please select at least one organization and one column option.", NotificationType.Error),
                                // Proceed to collect export data if validations pass
                                ClearCollect(
                                    ExportData,
                                    ForAll(
                                        Filter(
                                            Master_Data,
                                            NameofLeadOrg in ShowColumns(SelectedOrganizations, orgAcronym)
                                        ),
                                        {
                                            APFNum: APFU_ID_Num,
                                            NameofLeadOrg: If(ChkBoxOrgNames.Checked, NameofLeadOrg, Blank()),
                                            EventID: If(ChkBox_EventID.Checked, Title, Blank()),
                                            ActTitle: If(ChkBox_ActTitle.Checked, ActivityTitle, Blank()),
                                            LeadOrg: If(ChkBox_LeadOrg.Checked, NameofLeadOrg, Blank()),
                                            EventType: If(ChkBox_EventType.Checked, EventTypes, Blank()),
                                            TDate: If(ChkBox_TDate.Checked, Target_x0020_Date, Blank()),
                                            Venue: If(ChkBox_Venue.Checked, Venue_x002f_Platform, Blank()),
                                            PrimAud: If(ChkBox_PrimAud.Checked, ProjectedPrimaryAudience, Blank()),
                                            SecAud: If(ChkBox_SecAud.Checked, ProjectedSecondaryAudience, Blank()),
                                            Balance: If(ChkBox_Balance.Checked, Balance, Blank()),
                                            CostPerParticipant: If(ChkBox_CPP.Checked, CostPerParticipant, Blank()),
                                            CashAdv: If(ChkBox_CashAdv.Checked, CashAdvance, Blank()),
                                            TotalExpenses: If(ChkBox_TotalExp.Checked, TotalExpensesValue, Blank())
                                        }
                                    )
                                ))
                                ;
                            
                             
                             If(
                                    CurrentUser .userRoles.Id > 1,
                                    Set(reportOutput, ExportReport.Run(JSON(ExportData), orgReport)), // Use ExportData here
                                    /*
                                    If(
                                        IsBlank(OrgSelectorReport.SelectedText.orgName),
                                        Set(reportOutput, ExportReport.Run(JSON(ExportData), orgReport)), // Use ExportData here
                                        Set(reportOutput, ExportReport.Run(JSON(Filter(ExportData, NameofLeadOrg = OrgSelectorReport.SelectedText.orgName)), orgReport)) // Use ExportData here
                                    )
                                    */
                                    Set(reportOutput,ExportReport.Run(JSON(Filter(ExportData, NameofLeadOrg in ShowColumns(SelectedOrganizations, orgAcronym))), orgReport))
                            
                                )
                        Text: ="Preview Sample"
                        Width: =133
                        X: =640
                        Y: =455
                        ZIndex: =23

                    Icon22 As icon.CancelBadge:
                        Height: =50
                        Icon: =Icon.CancelBadge
                        OnSelect: =Set(openExportFilters,false)
                        Visible: =openExportFilters
                        Width: =50
                        X: =789
                        Y: =46
                        ZIndex: =24

                    TextCanvas10_1 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =54
                        Size: =20
                        Text: |-
                            ="Organization:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =148
                        X: =48
                        Y: =108
                        ZIndex: =26

                    ButtonCanvas9_2 As Button:
                        Appearance: ='ButtonCanvas.Appearance'.Outline
                        DisplayMode: =DisplayMode.Edit
                        Height: =26
                        IconStyle: ='ButtonCanvas.IconStyle'.Outline
                        OnSelect: |-
                            =// OnSelect property of the Select All button
                            UpdateContext({ SelectAllChecked: !SelectAllChecked });
                        Text: ="Select All"
                        Width: =86
                        X: =687
                        Y: =123
                        ZIndex: =30

                    ButtonCanvas9_3 As Button:
                        Appearance: ='ButtonCanvas.Appearance'.Outline
                        DisplayMode: =DisplayMode.Edit
                        Height: =26
                        IconStyle: ='ButtonCanvas.IconStyle'.Outline
                        OnSelect: |-
                            =// OnSelect property of the Select All button
                            UpdateContext({ SelectAllOrgChecked: !SelectAllOrgChecked });
                        Text: ="Select All"
                        Width: =86
                        X: =196
                        Y: =123
                        ZIndex: =31

                    Group8 As group:
                        Height: =5
                        Width: =5
                        X: =40
                        Y: =40
                        ZIndex: =31

                        ChkBox_EventID As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Event ID"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =160
                            X: =376
                            Y: =164
                            ZIndex: =4

                        ChkBox_ActTitle As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Activity Title"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =160
                            X: =376
                            Y: =202
                            ZIndex: =5

                        ChkBox_LeadOrg As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Lead Org"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =160
                            X: =376
                            Y: =240
                            ZIndex: =6

                        ChkBox_EventType As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Event Type"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =160
                            X: =376
                            Y: =275
                            ZIndex: =8

                        ChkBox_TDate As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Target Date"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =160
                            X: =376
                            Y: =313
                            ZIndex: =9

                        ChkBox_PrimAud As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Primary Audience"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =177
                            X: =600
                            Y: =162
                            ZIndex: =12

                        ChkBox_TotalExp As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Total Expenses"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =177
                            X: =600
                            Y: =273
                            ZIndex: =13

                        ChkBox_Balance As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: |-
                                ="
                                Balance"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =177
                            X: =600
                            Y: =308
                            ZIndex: =14

                        ChkBox_CPP As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Cost per Participant"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =177
                            X: =600
                            Y: =345
                            ZIndex: =15

                        ChkBox_SecAud As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Secondary Audience"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =177
                            X: =600
                            Y: =201
                            ZIndex: =27

                        ChkBox_CashAdv As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Cash Advanced"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =177
                            X: =600
                            Y: =239
                            ZIndex: =28

                        ChkBox_Venue As Checkbox:
                            Checked: =SelectAllChecked
                            DisplayMode: =DisplayMode.Edit
                            Height: =32
                            Label: ="Venue"
                            OnCheck: =false
                            OnUncheck: =false
                            Width: =160
                            X: =376
                            Y: =345
                            ZIndex: =29

            "'Right Container' As groupContainer.verticalAutoLayoutContainer":
                DropShadow: =DropShadow.Regular
                Fill: =RGBA(255, 255, 255, 1)
                FillPortions: =0.5
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutDirection: =LayoutDirection.Vertical
                LayoutGap: =5
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =300
                LayoutMinWidth: =If(Reports_1.Size = ScreenSize.Small, Parent.Width, 250)
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =10
                ZIndex: =3

                FiltersCont As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.Regular
                    FillPortions: =0.25
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    ZIndex: =1

                    OrgFilterCont As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0.5
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Visible: =If(CurrentUser.userRoles.Id > 1, false, true)
                        ZIndex: =1

                        TextCanvas9_1 As Text:
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =0.3
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            Size: =20
                            Text: |-
                                ="   Org Filter: "
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =96
                            X: =0
                            Y: =0
                            ZIndex: =1

                        OrgSelectorReport As dropdown:
                            AlignInContainer: =AlignInContainer.Stretch
                            AllowEmptySelection: =true
                            Default: =
                            FillPortions: =0.55
                            FontWeight: =FontWeight.Lighter
                            Height: =46
                            Items: =ShowColumns(Organizations,orgAcronym)
                            LayoutMinWidth: =80
                            OnChange: |+
                                =ClearCollect(
                                    FilteredDataTable,
                                    If(
                                        IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'),
                                        LocalPD, // Show all data if the dropdown is empty
                                        Filter(
                                            LocalPD,
                                            LR_ID.Id in Filter(LocalLR, EventOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName').ID
                                        )
                                    )    
                                );
                                
                                
                                // Update LocalAPF
                                /**
                                ClearCollect(
                                    LocalAPF,
                                    AddColumns(
                                        Filter(
                                            'APF Uploads',
                                            'Name of Lead Org' = Dropdown2_1.Selected.orgAcronym // Apply the filter based on dropdown selection
                                        ),
                                        APFU_ID_Num,
                                        ID
                                    )
                                );
                                
                                // Update LocalLR
                                ClearCollect(
                                    LocalLR,
                                    AddColumns(
                                        Filter(
                                            LR_Uploads,
                                            EventOrg = Dropdown2_1.Selected.orgAcronym // Filter based on EventOrg
                                        ),
                                        LR_ID_Num,
                                        ID,
                                        APF_ID_Num,
                                        APF_ID.Id
                                    )
                                );
                                
                                // Update LocalPD
                                ClearCollect(
                                    LocalPD,
                                    Filter(
                                        LR_PDItems,
                                        !IsBlank(
                                            LookUp(
                                                LocalLR,
                                                LR_ID_Num = LR_ID.Id // Check if there is a matching ID in LocalLR
                                            )
                                        )
                                    )
                                );
                                
                                // Update Master_Data
                                ClearCollect(
                                    Master_Data,
                                    AddColumns(
                                        ShowColumns(
                                            LocalAPF,
                                            APFU_ID_Num,
                                            ID,
                                            'Name of Lead Org',
                                            Title,
                                            'Activity Title',
                                            'Target Date',
                                            'Venue/Platform',
                                            'Workshop/Tech Training',
                                            'Seminar/Webinar/Symposium/Forum',
                                            'Leadership Training',
                                            'Academic Competition',
                                            'Culture & Arts',
                                            'Games & Sports',
                                            'Religious/Spiritual',
                                            'Community Ext',
                                            'Social Events',
                                            Marketing,
                                            'Projected Primary Audience',
                                            'Projected Secondary Audience'
                                        ),
                                        EventTypes,
                                        Concat(
                                            Filter(
                                                [
                                                    { Type: "Workshop", Value: ThisRecord.Workshop_x002f_TechTraining },
                                                    { Type: "Seminar", Value: ThisRecord.Seminar_x002f_Webinar_x002f_Symp },
                                                    { Type: "Leadership", Value: ThisRecord.LeadershipTraining },
                                                    { Type: "Academic", Value: ThisRecord.AcademicCompetition },
                                                    { Type: "Cultural", Value: ThisRecord.CultureArts },
                                                    { Type: "Sports", Value: ThisRecord.GamesSports },
                                                    { Type: "Religious", Value: ThisRecord.Religious_x002f_Spiritual },
                                                    { Type: "Community", Value: ThisRecord.CommunityExt },
                                                    { Type: "Social", Value: ThisRecord.SocialEvents },
                                                    { Type: "Marketing", Value: ThisRecord.Marketing }
                                                ],
                                                Value = true
                                            ),
                                            Type,
                                            "; "
                                        ),
                                        // Other calculations for CashAdvance, TotalExpenses, Balance
                                        CashAdvance,
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    LocalLR,
                                                    APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                    CashAdvAmt
                                                )
                                            ),
                                            0,
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                CashAdvAmt
                                            )
                                        ),
                                        TotalExpenses,
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    LocalLR,
                                                    APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                    TotalExpenses
                                                )
                                            ),
                                            0,
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                TotalExpenses
                                            )
                                        ),
                                        Balance,
                                        If(
                                            IsBlank(
                                                LookUp(
                                                    LocalLR,
                                                    APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                    Balance
                                                )
                                            ),
                                            0,
                                            LookUp(
                                                LocalLR,
                                                APFU_ID_Num = ThisRecord.APF_ID_Num,
                                                Balance
                                            )
                                        ),
                                        CostPerParticipant,
                                        If(
                                            Or(
                                                Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience) = 0,
                                                IsBlank(LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num, TotalExpenses))
                                            ),
                                            0,
                                            LookUp(LocalLR, APFU_ID_Num = ThisRecord.APF_ID_Num, TotalExpenses) / 
                                            Sum(ThisRecord.ProjectedPrimaryAudience, ThisRecord.ProjectedSecondaryAudience)
                                        )
                                    )
                                );
                                
                                // Update EventTypeReports
                                ClearCollect(
                                    EventTypeReports,
                                    {
                                        SeminarCount: CountIf(Master_Data, Seminar_x002f_Webinar_x002f_Symp = true),
                                        LeadershipCount: CountIf(Master_Data, LeadershipTraining = true),
                                        CommExtCount: CountIf(Master_Data, CommunityExt = true),
                                        MarketingCount: CountIf(Master_Data, Marketing = true),
                                        ReligiousCount: CountIf(Master_Data, Religious_x002f_Spiritual = true),
                                        AcadCompeCount: CountIf(Master_Data, AcademicCompetition = true),
                                        CultureCount: CountIf(Master_Data, CultureArts = true),
                                        GameCount: CountIf(Master_Data, GamesSports = true),
                                        SocialCount: CountIf(Master_Data, SocialEvents = true)
                                    }
                                );
                                **/
                                
                            Reset: =true
                            Width: =128
                            X: =10
                            Y: =33
                            ZIndex: =2

                        ButtonCanvas2_1 As Button:
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =0.15
                            Height: =46
                            LayoutMinHeight: =32
                            LayoutMinWidth: =40
                            OnSelect: |-
                                =// Reset the dropdown selection
                                    Reset(OrgSelectorReport);
                                    ClearCollect(
                                    FilteredDataTable,
                                    If(
                                        IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'),
                                        LocalPD, // Show all data if the dropdown is empty
                                        Filter(
                                            LocalPD,
                                            LR_ID.Id in Filter(LocalLR, EventOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName').ID
                                        )
                                    )    
                                );
                            Text: ="All"
                            Width: =54
                            X: =144
                            Y: =33
                            ZIndex: =3

                    AYFilterCont As groupContainer.horizontalAutoLayoutContainer:
                        FillPortions: =0.5
                        LayoutMinHeight: =50
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =2

                        TextCanvas9 As Text:
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =0.3
                            Height: =32
                            LayoutMinHeight: =32
                            LayoutMinWidth: =96
                            Size: =20
                            Text: |-
                                ="   AY Filter: "
                            Weight: ='TextCanvas.Weight'.Semibold
                            Width: =96
                            X: =0
                            Y: =0
                            ZIndex: =1

                        AcadYearSelector3 As dropdown:
                            AlignInContainer: =AlignInContainer.Stretch
                            AllowEmptySelection: =true
                            ChevronBackground: =RGBA(39, 113, 194, 1)
                            Color: =
                            Default: ="0"
                            FillPortions: =0.55
                            Height: =46
                            Items: =Distinct(CalDeets, AcadYear)
                            LayoutMinWidth: =80
                            OnChange: |-
                                =ClearCollect(
                                    FilteredDataTable,
                                    If(
                                        IsBlank(AcadYearSelector3.SelectedText.Value),
                                        LocalPD, // Show all data if the dropdown is empty
                                        Filter(
                                            LocalPD,
                                            LR_ID.Id in Filter(
                                                LocalLR,
                                                If(
                                                    Month(EventDate) = 8 || Month(EventDate) > 8,
                                                    Text(Year(EventDate), "[$-en-US]0") & "-" & Text(Year(EventDate) + 1, "[$-en-US]0"),
                                                    Text(Year(EventDate) - 1, "[$-en-US]0") & "-" & Text(Year(EventDate), "[$-en-US]0")
                                                ) = AcadYearSelector3.SelectedText.Value
                                            ).ID
                                        )
                                    )    
                                );
                            Reset: =true
                            Width: =136
                            X: =232
                            Y: =33
                            ZIndex: =2

                        AY_AllBtn_3 As Button:
                            AlignInContainer: =AlignInContainer.Stretch
                            DisplayMode: =DisplayMode.Edit
                            FillPortions: =0.15
                            Height: =46
                            LayoutMinHeight: =32
                            LayoutMinWidth: =40
                            OnSelect: =Reset(AcadYearSelector3)
                            Text: ="All"
                            Width: =54
                            X: =371
                            Y: =33
                            ZIndex: =3

                Container6_2 As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.Light
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    ZIndex: =3

                    TextCanvas6 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =63
                        Size: =30
                        Text: |-
                            ="Quick Stats:"
                        Weight: ='TextCanvas.Weight'.Bold
                        Width: =193
                        X: =45
                        Y: =27
                        ZIndex: =1

                    TextCanvas6_1 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Events Organized:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =193
                        X: =45
                        Y: =111
                        ZIndex: =2

                    TextCanvas6_2 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Total Participation:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =193
                        X: =45
                        Y: =209
                        ZIndex: =3

                    TextCanvas6_3 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Upcoming Events:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =193
                        X: =45
                        Y: =160
                        ZIndex: =4

                    TextCanvas6_5 As Text:
                        Align: ="Start"
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Total Budget Utilized:"
                        VerticalAlign: ="Middle"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =264
                        X: =45
                        Y: =258
                        ZIndex: =6

                    TextCanvas6_6 As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            ="Average Cost per Participant:"
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =296
                        X: =45
                        Y: =307
                        ZIndex: =7

                    TextCanvas6_7 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            =/*
                            If(
                                CurrentUser .userRoles.Id > 1, 
                                CountRows(Master_Data), 
                                If(
                                    IsBlank(OrgSelectorReport.SelectedText.orgName), 
                                    If(
                                        IsBlank(AcadYearSelector3.SelectedText.Value), 
                                        CountRows(Master_Data), // Count all if both are blank
                                        CountIf(
                                            Master_Data,
                                            (
                                                If(
                                                    Month(DateValue('Target_x0020_Date')) = 8 || Month(DateValue('Target_x0020_Date')) > 8,
                                                    Text(Year(DateValue('Target_x0020_Date')), "[$-en-US]0") & "-" & Text(Year(DateValue('Target_x0020_Date')) + 1, "[$-en-US]0"),
                                                    Text(Year(DateValue('Target_x0020_Date')) - 1, "[$-en-US]0") & "-" & Text(Year(DateValue('Target_x0020_Date')), "[$-en-US]0")
                                                ) = AcadYearSelector3.SelectedText.Value
                                            )
                                        )
                                    ), 
                                    CountIf(
                                        Master_Data,
                                        NameofLeadOrg = OrgSelectorReport.SelectedText.orgName &&
                                        (
                                            IsBlank(AcadYearSelector3.SelectedText.Value) || // Check if AcadYearSelector3 is blank
                                            If(
                                                Month(DateValue('Target_x0020_Date')) = 8 || Month(DateValue('Target_x0020_Date')) > 8,
                                                Text(Year(DateValue('Target_x0020_Date')), "[$-en-US]0") & "-" & Text(Year(DateValue('Target_x0020_Date')) + 1, "[$-en-US]0"),
                                                Text(Year(DateValue('Target_x0020_Date')) - 1, "[$-en-US]0") & "-" & Text(Year(DateValue('Target_x0020_Date')), "[$-en-US]0")
                                            ) = AcadYearSelector3.SelectedText.Value
                                        )
                                    )
                                )
                            )
                            */
                            
                            Switch(
                                true,
                                CurrentUser .userRoles.Id > 1, 
                                    CountRows(Master_Data), // Count all if user role is greater than 1
                                
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    CountRows(Master_Data), // Count all if both selectors are blank
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'), 
                                    CountIf(
                                        Master_Data,
                                        Text(
                                            Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) & "-" & Text(
                                            Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) = AcadYearSelector3.SelectedText.Value
                                    ),
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    CountIf(
                                        Master_Data,
                                        NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'
                                    ),
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    CountIf(
                                        Master_Data,
                                        NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName' &&
                                        Text(
                                            Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) & "-" & Text(
                                            Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) = AcadYearSelector3.SelectedText.Value
                                    )
                            )
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =291
                        Y: =111
                        ZIndex: =8

                    TextCanvas6_8 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            =/** 
                            If(CurrentUser.userRoles.Id > 1, 
                                Sum(Master_Data, ProjectedPrimaryAudience) + Sum(Master_Data, ProjectedSecondaryAudience), 
                                If(IsBlank(OrgSelectorReport.SelectedText.orgName), Sum(Master_Data, ProjectedPrimaryAudience) + Sum(Master_Data, ProjectedSecondaryAudience),
                                    Sum(Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.orgName), ProjectedPrimaryAudience) + 
                                    Sum(Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.orgName), ProjectedSecondaryAudience)
                                )
                            )
                            **/
                            
                            Switch(
                                true,
                                CurrentUser .userRoles.Id > 1, 
                                    Sum(Master_Data, ProjectedPrimaryAudience) + Sum(Master_Data, ProjectedSecondaryAudience), // Total for users with higher roles
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Sum(Master_Data, ProjectedPrimaryAudience) + Sum(Master_Data, ProjectedSecondaryAudience), // Total for all records if both selectors are blank
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Sum(
                                        Filter(
                                            Master_Data,
                                            Text(
                                                Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) & "-" & Text(
                                                Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) = AcadYearSelector3.SelectedText.Value
                                        ), 
                                        ProjectedPrimaryAudience
                                    ) + 
                                    Sum(
                                        Filter(
                                            Master_Data,
                                            Text(
                                                Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) & "-" & Text(
                                                Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) = AcadYearSelector3.SelectedText.Value
                                        ), 
                                        ProjectedSecondaryAudience
                                    ), // Filter by academic year if OrgSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Sum(
                                        Filter(
                                            Master_Data,
                                            NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'
                                        ), 
                                        ProjectedPrimaryAudience
                                    ) + 
                                    Sum(
                                        Filter(
                                            Master_Data,
                                            NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'
                                        ), 
                                        ProjectedSecondaryAudience
                                    ), // Filter by organization if AcadYearSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Sum(
                                        Filter(
                                            Master_Data,
                                            NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName' &&
                                            Text(
                                                Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) & "-" & Text(
                                                Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) = AcadYearSelector3.SelectedText.Value
                                        ), 
                                        ProjectedPrimaryAudience
                                    ) + 
                                    Sum(
                                        Filter(
                                            Master_Data,
                                            NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName' &&
                                            Text(
                                                Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) & "-" & Text(
                                                Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                "[$-en-US]0"
                                            ) = AcadYearSelector3.SelectedText.Value
                                        ), 
                                        ProjectedSecondaryAudience
                                    ) // Filter by organization and academic year
                            )
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =291
                        Y: =209
                        ZIndex: =9

                    TextCanvas6_9 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            =/*
                            If(CurrentUser.userRoles.Id > 1, 
                                CountIf(Master_Data,Target_x0020_Date >= Today()), 
                                If(IsBlank(OrgSelectorReport.SelectedText.orgName), CountIf(Master_Data,Target_x0020_Date >= Today()),
                                CountIf(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.orgName && Target_x0020_Date >= Today())
                                )
                            )
                            */
                            
                            Switch(
                                true,
                                CurrentUser .userRoles.Id > 1, 
                                    CountIf(Master_Data, Target_x0020_Date >= Today()), // Count all upcoming events for higher roles
                                
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    CountIf(Master_Data, Target_x0020_Date >= Today()), // Count all upcoming events if both selectors are blank
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    CountIf(
                                        Master_Data,
                                        Target_x0020_Date >= Today() &&
                                        Text(
                                            Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) & "-" & Text(
                                            Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) = AcadYearSelector3.SelectedText.Value
                                    ), // Filter by academic year if OrgSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    CountIf(
                                        Master_Data,
                                        NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName' &&
                                        Target_x0020_Date >= Today()
                                    ), // Filter by organization if AcadYearSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    CountIf(
                                        Master_Data,
                                        NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName' &&
                                        Target_x0020_Date >= Today() &&
                                        Text(
                                            Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) & "-" & Text(
                                            Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                            "[$-en-US]0"
                                        ) = AcadYearSelector3.SelectedText.Value
                                    ) // Filter by organization and academic year
                            )
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =291
                        Y: =160
                        ZIndex: =10

                    TextCanvas6_11 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            =/*
                            If(
                                CurrentUser .userRoles.Id > 1,
                                Concatenate(Round(Sum(Master_Data, TotalExpensesValue) / 11000 * 100, 2), "%"),
                                If(
                                    IsBlank(OrgSelectorReport.SelectedText.orgName),
                                    Concatenate(Round(Sum(Master_Data, TotalExpensesValue) / 11000 * 100, 2), "%"),
                                    Concatenate(
                                        Round(
                                            Sum(Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.orgName), TotalExpensesValue) / 11000 * 100,
                                            2
                                        ),
                                        "%"
                                    )
                                )
                            )
                            */
                            
                            Switch(
                                true,
                                CurrentUser .userRoles.Id > 1, 
                                    Concatenate(Round(Sum(Master_Data, TotalExpensesValue) / 11000 * 100, 2), "%"), // Total for users with higher roles
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Concatenate(Round(Sum(Master_Data, TotalExpensesValue) / 11000 * 100, 2), "%"), // Total for all records if both selectors are blank
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Concatenate(
                                        Round(
                                            Sum(
                                                Filter(
                                                    Master_Data,
                                                    Text(
                                                        Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                        "[$-en-US]0"
                                                    ) & "-" & Text(
                                                        Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                        "[$-en-US]0"
                                                    ) = AcadYearSelector3.SelectedText.Value
                                                ), 
                                                TotalExpensesValue
                                            ) / 11000 * 100,
                                            2
                                        ),
                                        "%"
                                    ), // Filter by academic year if OrgSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Concatenate(
                                        Round(
                                            Sum(
                                                Filter(
                                                    Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'
                                                ), 
                                                TotalExpensesValue
                                            ) / 11000 * 100,
                                            2
                                        ),
                                        "%"
                                    ), // Filter by organization if AcadYearSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Concatenate(
                                        Round(
                                            Sum(
                                                Filter(
                                                    Master_Data,
                                                    NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName' &&
                                                    Text(
                                                        Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                        "[$-en-US]0"
                                                    ) & "-" & Text(
                                                        Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                        "[$-en-US]0"
                                                    ) = AcadYearSelector3.SelectedText.Value
                                                ), 
                                                TotalExpensesValue
                                            ) / 11000 * 100,
                                            2
                                        ),
                                        "%"
                                    ) // Filter by organization and academic year
                            )
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =291
                        Y: =258
                        ZIndex: =12

                    TextCanvas6_12 As Text:
                        Align: ='TextCanvas.Align'.End
                        DisplayMode: =DisplayMode.Edit
                        Height: =49
                        Size: =20
                        Text: |-
                            =/**
                            If(
                                CurrentUser .userRoles.Id > 1,
                                Round(Sum(Master_Data, CostPerParticipant), 2),
                                If(
                                    IsBlank(OrgSelectorReport.SelectedText.orgName),
                                    Round(Sum(Master_Data, CostPerParticipant), 2),
                                    Round(
                                        Sum(
                                            Filter(Master_Data, NameofLeadOrg = OrgSelectorReport.SelectedText.orgName), 
                                            CostPerParticipant
                                        ), 
                                        2
                                    )
                                )
                            )
                            **/
                            
                            Switch(
                                true,
                                CurrentUser  .userRoles.Id > 1, 
                                    Round(Sum(Master_Data, CostPerParticipant), 2), // Total for users with higher roles
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Round(Sum(Master_Data, CostPerParticipant), 2), // Total for all records if both selectors are blank
                            
                                IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Round(
                                        Sum(
                                            Filter(
                                                Master_Data,
                                                Text(
                                                    Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                    "[$-en-US]0"
                                                ) & "-" & Text(
                                                    Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                    "[$-en-US]0"
                                                ) = AcadYearSelector3.SelectedText.Value
                                            ), 
                                            CostPerParticipant
                                        ), 
                                        2
                                    ), // Filter by academic year if OrgSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Round(
                                        Sum(
                                            Filter(
                                                Master_Data,
                                                NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName'
                                            ), 
                                            CostPerParticipant
                                        ), 
                                        2
                                    ), // Filter by organization if AcadYearSelector is blank
                            
                                !IsBlank(OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName') && !IsBlank(AcadYearSelector3.SelectedText.Value), 
                                    Round(
                                        Sum(
                                            Filter(
                                                Master_Data,
                                                NameofLeadOrg = OrgSelectorReport.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BorgName' &&
                                                Text(
                                                    Year(DateValue('Target_x0020_Date')) - If(Month(DateValue('Target_x0020_Date')) <= 8, 1, 0), 
                                                    "[$-en-US]0"
                                                ) & "-" & Text(
                                                    Year(DateValue('Target_x0020_Date')) + If(Month(DateValue('Target_x0020_Date')) > 8, 1, 0), 
                                                    "[$-en-US]0"
                                                ) = AcadYearSelector3.SelectedText.Value
                                            ), 
                                            CostPerParticipant
                                        ), 
                                        2
                                    ) // Filter by organization and academic year
                            )
                        Weight: ='TextCanvas.Weight'.Semibold
                        Width: =98
                        X: =291
                        Y: =307
                        ZIndex: =13

                    ButtonCanvas1_1 As Button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        DisplayMode: =DisplayMode.Edit
                        FontSize: =18
                        Height: =46
                        Icon: ="ArrowDownload"
                        OnSelect: |-
                            =Set(openExportFilters, true)
                            /*Set(isRunning,true);
                            
                            If(CurrentUser.userRoles.Id > 1, 
                                Set(reportOutput, ExportReport.Run(JSON(Master_Data),orgReport)),
                                If(IsBlank(OrgSelectorReport.SelectedText.orgName), Set(reportOutput, ExportReport.Run(JSON(Master_Data),orgReport));,
                                    Set(reportOutput, ExportReport.Run(JSON(Filter(Master_Data,NameofLeadOrg = OrgSelectorReport.SelectedText.orgName)),orgReport));
                                )
                            );
                            
                            Set(isRunning, false);
                            */
                        Text: ="Export Report"
                        Visible: =true
                        Width: =204
                        X: =120
                        Y: =380
                        ZIndex: =14

                Container16 As groupContainer.manualLayoutContainer:
                    AlignInContainer: ='Right Container'.AlignInContainer
                    DropShadow: =DropShadow.Light
                    Fill: =RGBA(0, 0, 0, 0.14)
                    FillPortions: =0.3
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    ZIndex: =4

                    ReportLink As Text:
                        DisplayMode: =DisplayMode.Edit
                        Height: =82
                        Size: =15
                        Text: =//reportOutput.reportlink
                        Width: =381
                        X: =47
                        Y: =12
                        ZIndex: =1

    TSKBR_14 As TSKBR:
        NavigationItems: =gblNavItems
        ZIndex: =3

    SetDelay_2 As timer:
        Duration: =6000
        Height: =0
        OnTimerEnd: |-
            =
            Set(isRunning, true); 
            Set(TimerDone, true);
        OnTimerStart: |-
            =SetDelay_2;
            Set(isRunning, false);
            Set(TimerDone, false);
        Repeat: =isRunning
        Reset: =TimerDone
        Width: =0
        Y: =768
        ZIndex: =4

    LoadScreenPanel_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =8

        Rectangle6_8 As rectangle:
            Fill: =RGBA(0, 0, 0, 0.2)
            Height: =768
            Visible: =isRunning
            Width: =1366
            ZIndex: =2

        Rectangle6_7 As rectangle:
            Fill: =RGBA(24, 32, 82, 1)
            Height: =330
            Visible: =isRunning
            Width: =825
            X: =275
            Y: =238
            ZIndex: =6

        Image7_4 As image:
            Image: ='Spinner-1.5s-200px'
            Visible: =isRunning
            X: =633
            Y: =442
            ZIndex: =7

        Label2_4 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Font: =Font.'Lato Black'
            Height: =214
            Size: =30
            Text: ="Processing your document. Please wait."
            Visible: =isRunning
            Width: =624
            X: =371
            Y: =267
            ZIndex: =8

